<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <style type="text/css">
    </style>
  </head>
  <body>
    <div id="body">
      <div id="my_dataviz"></div>
    </div>
    <!-- <script src="https://d3js.org/d3.v4.min.js"></script> -->
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="src/js/complete.js"></script>
    <script type="text/javascript">
      var vetBio = vetSociais = vetExatas = vetEng = vetSaude = [];
      pessoas.nodes.forEach((el, index) => {
        if (el.color == 'rgba(0, 184, 104, 0.5)') {
          vetBio.push(el);
        }
        if (el.color == 'rgba(224, 79, 46, 0.5)') {
          vetSociais.push(el);
        }
        if (el.color == 'rgba(245, 235, 53, 0.5)') {
          vetExatas.push(el);
        }
        if (el.color == 'rgba(214, 171, 252 ,0.5)') {
          vetEng.push(el);
        }
        if (el.color == 'rgba(38, 135, 252, 0.5)') {
          vetSaude.push(el);
        }
      });

      var myJson = {
          "id": "main",
        "children": [
          {
              "id": "biologicas",
            "children": vetBio
          },
          {
              "id": "sociais",
            "children": vetSociais
          },
          {
              "id": "exatas",
            "children": vetExatas
          },
          {
              "id": "engenharias",
            "children": vetEng
          },
          {
              "id": "saude",
            "children": vetSaude
          }
        ]
      };

      // set the dimensions and margins of the graph
      var margin = {top: 10, right: 10, bottom: 10, left: 10},
        width = 445 - margin.left - margin.right,
        height = 445 - margin.top - margin.bottom;

      // append the svg object to the body of the page
      var svg = d3.select("#my_dataviz")
      .append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
      .append("g")
        .attr("transform",
              "translate(" + margin.left + "," + margin.top + ")");

      var color = d3.scaleOrdinal(d3.schemeCategory10);

      var root = d3.hierarchy(myJson);
      var treemapLayout = d3.treemap();
      treemapLayout
        .size([500, 500])
        .paddingOuter(10);
      root.sum(function(d) {
        return d.value;
      });
      treemapLayout(root);
      svg
        .selectAll('rect')
        .data(root.descendants())
        .enter()
        .append("rect")
          .attr('x', function (d) { return d.x0; })
          .attr('y', function (d) { return d.y0; })
          .attr('fill', function(d) {return d.children ? null : color(d.parent.id);})
          .attr("fill-opacity", 0.6)
          .attr('width', function (d) { return d.x1 - d.x0; })
          .attr('height', function (d) { return d.y1 - d.y0; })
          .attr('stroke', '#fff');
      // svg
      //   .selectAll('text')
      //   .data(root.descendants())
      //   .enter()
      //   .append("text")
      //     .attr('x', function (d) { return d.x + d.dx /2; })
      //     .attr('y', function (d) { return d.y + d.dy /2; })
      //     .text(function(d) {return d.id})
    </script>
  </body>
</html>